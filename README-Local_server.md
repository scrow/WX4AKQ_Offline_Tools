# Services Available from a Local Web Server

A local web server provides the ability to queue up reports on the local desktop/laptop for future transmission to SKYWARN servers when Internet connectivity is available.  This also provides some limited report editing capability, a small offline file repository, and the ability to perform automated call sign lookups on the NCO report form, similar to the functionality built in to Ops Portal.

This type of installation also provides access to the custom templates for Winlink Express.  See `README-Winlink_only.md` for information.

## Enhanced capabilities

Several special features are enabled when running from a web server:

  1. SKYWARN amateur radio team members (Net Controls, Responders, Leadership, etc) have access to an offline copy of the latest Team Roster.
  2. Optional offline FCC database for use with the NCO Report Form, similar to the lookup functionality currently provided in the NCO Dashboard on Ops Portal.
  3. Offline files.  These include copies of reporting criteria, paper log sheets, and other reference material, and could potentially include event-specific information packs such as ICS-205's.

These features all require configuration of a valid API key as described earlier in this document.  To retrieve these features, use the "Download Offline Data and Files from Server" option on the main menu.

The offline FCC database is currently updated once weekly and the "Include FCC database when downloading from server" option must be enabled in the System Configuration.  Disabling this option will not remove existing FCC data, but will prevent retrieval of the latest update.  Note that the FCC database is approximately a 75 MB download, so users over slow or restricted Internet connections may wish to forego this update.

## API Key Required

The "NCO Report Form" requires an API Key to submit reports from a local web server.  SKYWARN Net Controls can obtain their API key by logging in to [Ops Portal](https://ops.wx4akq.org) and clicking on the [My Account](https://ops.wx4akq.org/myaccount.php) link.

## Running from a Local Web Server

The forms included in this project can also be accessed through a local web server.  In this configuration, there are four ways to get reports to the SKYWARN team:

  1. Reports can be staged in a queue folder and either:
	  a. Uploaded to the SKYWARN server once Internet access is restored using a built-in uploader tool; or,
	  b. Manually attached to an e-mail or Winlink message.
  2. Reports can be downloaded as an XML file to be:
	  a. Uploaded through a web browser; or,
	  b. Manually attached to an e-mail or Winlink message.

## Using an Existing Local Web Server

An existing locally-installed web server can be used.  Installing, configuring, and troubleshooting issues with a locally-installed web server are outside the scope of this documentation.  The server used must have PHP 5.3 or higher with the PHP `cURL` and `sqlite3` extensions installed.  This documentation assumes a modern Apache web serer.

  1. Copy the project files to your web server's content folder, such as `/var/www/sites/`
  2. Copy `.htaccess.example` to `.htaccess`.
  3. If the server will be running on an exposed port, edit the `.htaccess` file to enable password authentication using an `.htpasswd` file.  Refer to your server's documentation for detailed instructions.
  4. Browse to the `index.php` file.

## Manually Submitting reports

To manually submit an `.XML` file generated by the Offline Tools, send it to the SKYWARN server using any of these methods:

  1. Via Winlink e-mail from a call sign recognized by the SKYWARN Ops Portal as a member of the `nco`, `responder`, `leadership`, or `areamgrs` permission group.
  2. Via e-mail to `xmlsubmit@wx4akq.org` from an e-mail address registered in the SKYWARN Team Roster on Ops Portal.
  3. Using the Upload functionality when the form is accessed from a local web server.
  4. Via upload to `https://ops.wx4akq.org/xml_upload.php`
